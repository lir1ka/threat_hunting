---
title: "pr 02 Vakhrameev"
author: "vakhrameevaleksandr@yandex.ru"
format:
    md: 
        output-file: README.md
---

## Цель работы

1. На практике освоить работу с языком программирования R в контексте анализа табличных данных  
2. Углубить понимание базовых структур данных в R, особенно data.frame  
3. Получить навыки применения ключевых функций из пакета `dplyr` — таких как `select()`, `filter()`, `mutate()`, `arrange()` и `group_by()`

## Исходные данные

1.  Оепрационная система Darwin Mac.lan 25.0.0 Darwin Kernel Version 25.0.0
2.  IDE Positron
3.  R version 4.5.2

## Задание
С использованием пакета `dplyr` выполнить серию базовых операций над встроенным датасетом `starwars` и ответить на ряд аналитических вопросов.

### Шаг 1

Подключаем библиотек `dplyr`:

```{r}
library(dplyr)
```

## Ход работы

1. Проанализировать встроенный в пакет dplyr набор данных starwars с помощью языка R и ответить на вопросы:
    - Сколько строк в датафрейме?
    - Сколько столбцов в датафрейме?
    - Как просмотреть примерный вид датафрейма?
    - Сколько уникальных рас персонажей (species) представлено в данных?
    - Найти самого высокого персонажа.
    - Найти всех персонажей ниже 170
    - Подсчитать ИМТ (индекс массы тела) для всех персонажей.
    - Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по отношению массы (mass) к росту (height) персонажей
    - Найти средний возраст персонажей каждой расы вселенной Звездных войн
    - Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.
    - Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.
2. Оформить отчет в соответствии с шаблоном


### Шаг №1

Вначале необходимо установить пакет `dlpyr`. Сделаем это с помощью команды
```
install.packages("dplyr")
```

Теперь подключим пакет для работы.

```{r}
library(dplyr)
```
    

Далее отвечаем на поставленные вопросы

#### Сколько строк в датафрейме?

```{r}
starwars %>% nrow()
```

#### Сколько столбцов в датафрейме?


```{r}
starwars %>% ncol()
```

#### Как просмотреть примерный вид датафрейма?

```{r}
starwars %>% glimpse()
```

#### Сколько уникальных рас персонажей (species) представлено в данных?

```{r}
starwars %>% select(., species) %>% filter(!is.na(species)) %>% unique(.) %>% count(.) |> knitr::kable(format = "markdown")
```

#### Найти самого высокого персонажа.

```{r}
starwars %>% arrange(., desc(height)) %>% select(name) %>% slice(1)  |> knitr::kable(format = "markdown")
```

#### Найти всех персонажей ниже 170
 
```{r}
starwars %>% filter(height < 170) %>% select(., name, height)|> knitr::kable(format = "markdown")
```

#### Подсчитать ИМТ (индекс массы тела) для всех персонажей.

```{r}
starwars %>% mutate(., imt = mass / (height^2)) %>% select(., name, imt) |> knitr::kable(format = "markdown")
```

#### Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по отношению массы (mass) к росту (height) персонажей
 
```{r}
starwars %>%
  filter(!is.na(mass), !is.na(height)) %>%
  mutate(stretched = mass / height) %>%
  arrange(stretched) %>%
  head(10) %>%
  select(name, stretched) %>%
  knitr::kable(format = "markdown")
```


#### Найти средний возраст персонажей каждой расы вселенной Звездных войн

```{r}
starwars %>%
  filter(!is.na(birth_year), !is.na(species)) %>%
  group_by(species) %>%
  summarise(avg_birth = mean(birth_year, na.rm = TRUE), .groups = "drop") %>%
  select(species, avg_birth) %>%
  knitr::kable(format = "markdown")
```

#### Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.

```{r}
starwars %>%
  count(eye_color, sort = TRUE) %>%
  slice(1) %>%
  pull(eye_color)
```

#### Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.

```{r}
starwars %>%
  filter(!is.na(species)) %>%
  mutate(name_len = nchar(name)) %>%
  group_by(species) %>%
  summarise(mean_name_length = mean(name_len, na.rm = TRUE), .groups = "drop") %>%
  select(species, mean_name_length) %>%
  knitr::kable(format = "markdown")
```

### Шаг 2

Отчет сделан и подготовлен согласно требованиям. На все вопросы получены ответы с помощью ЯП R и пакета `dplyr`.